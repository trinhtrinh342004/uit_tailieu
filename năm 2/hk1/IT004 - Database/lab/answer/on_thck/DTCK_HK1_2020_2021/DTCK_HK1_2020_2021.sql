--ĐỀ 1
CREATE DATABASE HK1_2020_2021
USE HK1_2020_2021

-- Tạo bảng BENHNHAN
CREATE TABLE BENHNHAN (
  MABN INT PRIMARY KEY,
  HOTEN VARCHAR(255),
  NGSINH DATE,
  CMND VARCHAR(20),
  DIACHI VARCHAR(255),
  DOITUONG VARCHAR(50),
  SLPT INT
);

-- Tạo bảng KHAMBENH
CREATE TABLE KHAMBENH (
  MAKB INT PRIMARY KEY,
  MABN INT,
  BENH VARCHAR(255),
  BENHKT VARCHAR(255),
  BATDAU DATETIME,
  KETTHUC DATETIME,
  KETLUAN VARCHAR(255),
  TAIKHAM DATE,
  FOREIGN KEY (MABN) REFERENCES BENHNHAN(MABN)
);

-- Tạo bảng PHAUTHUAT
CREATE TABLE PHAUTHUAT (
  MAPT INT PRIMARY KEY,
  MAKB INT,
  BOPHANPT VARCHAR(255),
  LOAIPT VARCHAR(255),
  KETQUA VARCHAR(255),
  FOREIGN KEY (MAKB) REFERENCES KHAMBENH(MAKB)
);

-- Tạo bảng BACSI
CREATE TABLE BACSI (
  MABS INT PRIMARY KEY,
  HOTEN VARCHAR(255),
  NAMSINH DATE,
  CHUYENMON VARCHAR(255),
  KHOA VARCHAR(255),
  BENHVIEN VARCHAR(255)
);

-- Tạo bảng PHUTRACH
CREATE TABLE PHUTRACH (
  MAKB INT,
  MABS INT,
  BATDAUPT DATETIME,
  KETTHUCPT DATETIME,
  PRIMARY KEY (MAKB, MABS),
  FOREIGN KEY (MAKB) REFERENCES KHAMBENH(MAKB),
  FOREIGN KEY (MABS) REFERENCES BACSI(MABS)
);
SET DATEFORMAT DMY
-- Nhập dữ liệu tùy ý vào các bảng
INSERT INTO BENHNHAN (MABN, HOTEN, NGSINH, CMND, DIACHI, DOITUONG, SLPT)
VALUES
  (1, 'Nguyễn Văn A', '1990-01-01', '123456789', 'Đồng Nai', 'BHYT', 2),
  (2, 'Trần Thị B', '1985-05-10', '987654321', 'Hồ Chí Minh', 'BHYT', 1),
  (3, 'Lê Văn C', '1995-12-25', '456789123', 'Hà Nội', 'BHYT', 0);

INSERT INTO KHAMBENH (MAKB, MABN, BENH, BENHKT, BATDAU, KETTHUC, KETLUAN, TAIKHAM)
VALUES
  (1, 1, 'Cảm cúm', NULL, '2020-05-10 09:00:00', '2020-05-10 09:30:00', 'Bình thường', NULL),
  (2, 1, 'Viêm họng', 'Viêm xoang', '2020-07-15 14:00:00', '2020-07-15 15:00:00', 'Nghiêm trọng', '2020-07-22'),
  (3, 2, 'Đau bụng', NULL, '2021-02-20 10:30:00', '2021-02-20 11:15:00', 'Bình thường', NULL);

INSERT INTO PHAUTHUAT (MAPT, MAKB, BOPHANPT, LOAIPT, KETQUA)
VALUES
  (1, 2, 'Tai trái', 'Phẫu thuật nội soi', 'Thành công'),
  (2, 3, 'Dạ dày', 'Phẫu thuật mở', 'Thành công');

INSERT INTO BACSI (MABS, HOTEN, NAMSINH, CHUYENMON, KHOA, BENHVIEN)
VALUES
  (1, 'Nguyễn Hữu D', '1978-08-15', 'Hồi sức - Cấp cứu', 'Khoa Hồi sức - Cấp cứu', 'Bệnh viện X'),
  (2, 'Trần Thị E', '1980-06-20', 'Tai-Mũi-Họng', 'Khoa Tai-Mũi-Họng', 'Bệnh viện Y'),
  (3, 'Lê Văn F', '1992-03-12', 'Răng-Hàm-Mặt', 'Khoa Răng-Hàm-Mặt', 'Bệnh viện Z');

INSERT INTO PHUTRACH (MAKB, MABS, BATDAUPT, KETTHUCPT)
VALUES
  (2, 1, '2020-07-15 14:00:00', '2020-07-15 15:00:00'),
  (3, 3, '2021-02-20 10:30:00', '2021-02-20 11:15:00');

--“Số lần phẫu thuật của một bệnh nhân phải bằng số lần phẫu thuật được chỉ định qua các lần khám 
--của bệnh nhân đó.” 